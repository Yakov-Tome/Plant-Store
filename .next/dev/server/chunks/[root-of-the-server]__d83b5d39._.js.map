{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/admin/Desktop/mashtela/src/app/api/contact/route.js"],"sourcesContent":["export async function POST(req) {\r\n  try {\r\n    const { name, email, message } = await req.json();\r\n\r\n    if (!name || !email || !message) {\r\n      return Response.json({ error: \"Missing fields\" }, { status: 400 });\r\n    }\r\n\r\n    const apiKey = process.env.MAILJET_API_KEY;\r\n    const secretKey = process.env.MAILJET_SECRET_KEY;\r\n    const toEmail = process.env.CONTACT_RECEIVER_EMAIL;\r\n\r\n    // âœ… MUST be a verified sender in Mailjet\r\n    const fromEmail = process.env.MAILJET_FROM_EMAIL || toEmail;\r\n\r\n    if (!apiKey || !secretKey || !toEmail || !fromEmail) {\r\n      return Response.json(\r\n        { error: \"Missing server env vars\" },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    const auth = Buffer.from(`${apiKey}:${secretKey}`).toString(\"base64\");\r\n\r\n    const mailjetRes = await fetch(\"https://api.mailjet.com/v3.1/send\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        Authorization: `Basic ${auth}`,\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        Messages: [\r\n          {\r\n            From: { Email: fromEmail, Name: \"×˜×•×¤×¡ ×™×¦×™×¨×ª ×§×©×¨\" },\r\n            To: [{ Email: toEmail, Name: \"×‘×¢×œ ×”×¢×¡×§\" }],\r\n            ReplyTo: { Email: email, Name: name }, // âœ… reply goes to the customer\r\n            Subject: \"ðŸ“© ×¤× ×™×™×” ×—×“×©×” ×ž×”××ª×¨\",\r\n            TextPart: `×©×: ${name}\\n××™×ž×™×™×œ: ${email}\\n\\n×”×•×“×¢×”:\\n${message}`,\r\n          },\r\n        ],\r\n      }),\r\n    });\r\n\r\n    const mj = await mailjetRes.json().catch(() => null);\r\n\r\n    // Mailjet can return 200 but still have errors in the body\r\n    const status = mj?.Messages?.[0]?.Status;\r\n    const errorInfo =\r\n      mj?.Messages?.[0]?.Errors?.[0]?.ErrorMessage ||\r\n      mj?.Messages?.[0]?.Errors?.[0]?.ErrorRelatedTo;\r\n\r\n    if (!mailjetRes.ok || status !== \"success\") {\r\n      console.error(\"Mailjet error:\", mailjetRes.status, mj);\r\n      return Response.json(\r\n        { error: errorInfo || \"Mailjet request failed\", raw: mj },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    return Response.json({ success: true });\r\n  } catch (err) {\r\n    console.error(err);\r\n    return Response.json({ error: \"Server error\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAO,eAAe,KAAK,GAAG;IAC5B,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,IAAI;QAE/C,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,SAAS;YAC/B,OAAO,SAAS,IAAI,CAAC;gBAAE,OAAO;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QAClE;QAEA,MAAM,SAAS,QAAQ,GAAG,CAAC,eAAe;QAC1C,MAAM,YAAY,QAAQ,GAAG,CAAC,kBAAkB;QAChD,MAAM,UAAU,QAAQ,GAAG,CAAC,sBAAsB;QAElD,yCAAyC;QACzC,MAAM,YAAY,QAAQ,GAAG,CAAC,kBAAkB,IAAI;QAEpD,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,WAAW,CAAC,WAAW;YACnD,OAAO,SAAS,IAAI,CAClB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,OAAO,IAAI,CAAC,GAAG,OAAO,CAAC,EAAE,WAAW,EAAE,QAAQ,CAAC;QAE5D,MAAM,aAAa,MAAM,MAAM,qCAAqC;YAClE,QAAQ;YACR,SAAS;gBACP,eAAe,CAAC,MAAM,EAAE,MAAM;gBAC9B,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB,UAAU;oBACR;wBACE,MAAM;4BAAE,OAAO;4BAAW,MAAM;wBAAiB;wBACjD,IAAI;4BAAC;gCAAE,OAAO;gCAAS,MAAM;4BAAW;yBAAE;wBAC1C,SAAS;4BAAE,OAAO;4BAAO,MAAM;wBAAK;wBACpC,SAAS;wBACT,UAAU,CAAC,IAAI,EAAE,KAAK,UAAU,EAAE,MAAM,YAAY,EAAE,SAAS;oBACjE;iBACD;YACH;QACF;QAEA,MAAM,KAAK,MAAM,WAAW,IAAI,GAAG,KAAK,CAAC,IAAM;QAE/C,2DAA2D;QAC3D,MAAM,SAAS,IAAI,UAAU,CAAC,EAAE,EAAE;QAClC,MAAM,YACJ,IAAI,UAAU,CAAC,EAAE,EAAE,QAAQ,CAAC,EAAE,EAAE,gBAChC,IAAI,UAAU,CAAC,EAAE,EAAE,QAAQ,CAAC,EAAE,EAAE;QAElC,IAAI,CAAC,WAAW,EAAE,IAAI,WAAW,WAAW;YAC1C,QAAQ,KAAK,CAAC,kBAAkB,WAAW,MAAM,EAAE;YACnD,OAAO,SAAS,IAAI,CAClB;gBAAE,OAAO,aAAa;gBAA0B,KAAK;YAAG,GACxD;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,SAAS,IAAI,CAAC;YAAE,SAAS;QAAK;IACvC,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC;QACd,OAAO,SAAS,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IAChE;AACF"}}]
}